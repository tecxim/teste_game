<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Jogo da Velha Cartoon</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: #f7f9fc;
      font-family: 'Comic Sans MS', cursive, sans-serif;
      padding-top: 30px;
    }
    h1 {
      text-align: center;
      font-size: 3rem;
      margin-bottom: 20px;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      max-width: 300px;
      margin: 0 auto;
    }
    .cell {
      width: 100px;
      height: 100px;
      font-size: 2.5rem;
      background-color: #fff;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .cell:hover {
      transform: scale(1.05);
    }
    .emoji {
      font-size: 2.2rem;
    }
    #status {
      text-align: center;
      margin-top: 20px;
      font-size: 1.5rem;
    }
    #restart {
      display: block;
      margin: 20px auto;
    }
  </style>
</head>
<body>

  <div class="container text-center">
    <h1>üéÆ Jogo da Velha Cartoon</h1>

    <!-- Escolha de s√≠mbolo -->
    <div id="chooseSymbol" class="mb-4">
      <h4>Escolha seu s√≠mbolo:</h4>
      <button class="btn btn-primary m-2" onclick="setPlayer('‚ùå')">‚ùå</button>
      <button class="btn btn-success m-2" onclick="setPlayer('‚≠ï')">‚≠ï</button>
    </div>

    <!-- Tabuleiro -->
    <div id="game" class="board d-none"></div>

    <!-- Status -->
    <div id="status" class="mt-3"></div>

    <!-- Bot√£o Reiniciar -->
    <button id="restart" class="btn btn-warning d-none" onclick="restartGame()">üîÅ Jogar Novamente</button>
  </div>

  <!-- üéµ M√∫sica de fundo -->
  <audio id="bgMusic" autoplay loop>
    <source src="https://www.bensound.com/bensound-music/bensound-buddy.mp3" type="audio/mpeg">
    Seu navegador n√£o suporta √°udio HTML5.
  </audio>

  <script>
    let board = ["", "", "", "", "", "", "", "", ""];
    let playerSymbol = "";
    let systemSymbol = "";
    let currentPlayer = "player";
    let gameActive = true;

    const winningCombos = [
      [0,1,2], [3,4,5], [6,7,8], // linhas
      [0,3,6], [1,4,7], [2,5,8], // colunas
      [0,4,8], [2,4,6]           // diagonais
    ];

    const emojis = {
      "‚ùå": "üòº",
      "‚≠ï": "üêµ"
    };

    // M√∫sica de fundo
    const music = document.getElementById("bgMusic");
    music.volume = 0.4; // volume inicial suave
    // tenta tocar automaticamente ap√≥s intera√ß√£o do usu√°rio
    document.body.addEventListener('click', () => {
      music.play().catch(() => {});
    }, { once: true });

    function setPlayer(symbol) {
      playerSymbol = symbol;
      systemSymbol = (symbol === "‚ùå") ? "‚≠ï" : "‚ùå";
      document.getElementById('chooseSymbol').classList.add('d-none');
      document.getElementById('game').classList.remove('d-none');
      renderBoard();
      if (currentPlayer === "system") systemMove();
    }

    function renderBoard() {
      const gameDiv = document.getElementById("game");
      gameDiv.innerHTML = "";
      board.forEach((cell, index) => {
        const div = document.createElement("div");
        div.classList.add("cell");
        div.innerHTML = cell ? `<span class="emoji">${emojis[cell]}</span>` : "";
        div.addEventListener("click", () => handleMove(index));
        gameDiv.appendChild(div);
      });
    }

    function handleMove(index) {
      if (!gameActive || board[index] || currentPlayer !== "player") return;
      board[index] = playerSymbol;
      currentPlayer = "system";
      renderBoard();
      checkGameOver();
      if (gameActive) {
        setTimeout(systemMove, 600); // Delay animado
      }
    }

    function systemMove() {
      if (!gameActive) return;
      let move = findBestMove(systemSymbol);
      if (move === null) move = findBestMove(playerSymbol);
      if (move === null) {
        let emptyIndices = board.map((val, i) => val === "" ? i : null).filter(i => i !== null);
        move = emptyIndices[Math.floor(Math.random() * emptyIndices.length)];
      }
      board[move] = systemSymbol;
      currentPlayer = "player";
      renderBoard();
      checkGameOver();
    }

    function findBestMove(symbol) {
      for (let combo of winningCombos) {
        const [a, b, c] = combo;
        let values = [board[a], board[b], board[c]];
        let countSymbol = values.filter(v => v === symbol).length;
        let countEmpty = values.filter(v => v === "").length;
        if (countSymbol === 2 && countEmpty === 1) {
          return [a, b, c].find(i => board[i] === "");
        }
      }
      return null;
    }

    function checkGameOver() {
      for (let combo of winningCombos) {
        const [a, b, c] = combo;
        if (board[a] && board[a] === board[b] && board[a] === board[c]) {
          gameActive = false;
          document.getElementById("status").textContent =
            board[a] === playerSymbol ? "üéâ Voc√™ venceu!" : "üò¢ O sistema venceu!";
          document.getElementById("restart").classList.remove("d-none");
          return;
        }
      }
      if (!board.includes("")) {
        gameActive = false;
        document.getElementById("status").textContent = "ü§ù Empate!";
        document.getElementById("restart").classList.remove("d-none");
      }
    }

    function restartGame() {
      board = ["", "", "", "", "", "", "", "", ""];
      currentPlayer = "player";
      gameActive = true;
      document.getElementById("status").textContent = "";
      document.getElementById("restart").classList.add("d-none");
      renderBoard();
      if (playerSymbol === "") {
        document.getElementById('chooseSymbol').classList.remove('d-none');
        document.getElementById('game').classList.add('d-none');
      }
    }
  </script>

</body>
</html>
